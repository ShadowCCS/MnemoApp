<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:Mnemo.UI.Controls"
        x:ClassModifier="internal"
        x:CompileBindings="True">
  <Design.PreviewWith>
    <Border Padding="20">
      <StackPanel Spacing="10" Width="300">
        <controls:ModernComboBox PlaceholderText="Select an option">
          <ComboBoxItem>Modern Item 1</ComboBoxItem>
          <ComboBoxItem>Modern Item 2</ComboBoxItem>
          <ComboBoxItem>Modern Item 3</ComboBoxItem>
        </controls:ModernComboBox>
        
        <controls:ModernComboBox SelectedIndex="0">
          <ComboBoxItem>Selected Item</ComboBoxItem>
          <ComboBoxItem>Other Item</ComboBoxItem>
        </controls:ModernComboBox>

        <controls:ModernComboBox IsEnabled="False" PlaceholderText="Disabled">
          <ComboBoxItem>Item 1</ComboBoxItem>
        </controls:ModernComboBox>
      </StackPanel>
    </Border>
  </Design.PreviewWith>

  <Styles.Resources>
    <ResourceDictionary>
      <ControlTheme x:Key="{x:Type controls:ModernComboBox}" TargetType="controls:ModernComboBox">
    <Setter Property="Cursor" Value="Hand" />
    <Setter Property="Padding" Value="12,6,12,6" />
    <Setter Property="FocusAdorner" Value="{x:Null}" />
    <Setter Property="MaxDropDownHeight" Value="300" />
    <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
    <Setter Property="Background" Value="{DynamicResource ComboBoxBackgroundBrush}" />
    <Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderBrush}" />
    <Setter Property="BorderThickness" Value="1" />
    <Setter Property="CornerRadius" Value="8" />
    <Setter Property="MinHeight" Value="36" />
    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Template">
      <ControlTemplate>
        <DataValidationErrors>
          <Grid ColumnDefinitions="*,Auto">
            <Border x:Name="Background"
                    Grid.ColumnSpan="2"
                    Background="{TemplateBinding Background}"
                    BorderBrush="{TemplateBinding BorderBrush}"
                    BorderThickness="{TemplateBinding BorderThickness}"
                    CornerRadius="{TemplateBinding CornerRadius}">
              <Border.Transitions>
                <Transitions>
                  <BrushTransition Property="Background" Duration="00:00:00.2" />
                  <BrushTransition Property="BorderBrush" Duration="00:00:00.2" />
                </Transitions>
              </Border.Transitions>
            </Border>

            <TextBlock x:Name="PlaceholderTextBlock"
                       Grid.Column="0"
                       HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                       VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                       Margin="{TemplateBinding Padding}"
                       Text="{TemplateBinding PlaceholderText}"
                       Foreground="{DynamicResource TextSecondaryBrush}"
                       IsVisible="{TemplateBinding SelectionBoxItem, Converter={x:Static ObjectConverters.IsNull}}" />
            
            <ContentControl x:Name="ContentPresenter"
                            Grid.Column="0"
                            Content="{TemplateBinding SelectionBoxItem}"
                            ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                            Margin="{TemplateBinding Padding}"
                            HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                            VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}" />

            <PathIcon Name="DropDownGlyph"
                      Grid.Column="1"
                      Width="12"
                      Height="12"
                      Margin="0,0,12,0"
                      Data="M7 10l5 5 5-5z"
                      Foreground="{DynamicResource TextSecondaryBrush}"
                      VerticalAlignment="Center"
                      HorizontalAlignment="Right"
                      IsHitTestVisible="False" />

            <Popup Name="PART_Popup"
                   WindowManagerAddShadowHint="False"
                   IsOpen="{TemplateBinding IsDropDownOpen, Mode=TwoWay}"
                   MinWidth="{Binding Bounds.Width, RelativeSource={RelativeSource TemplatedParent}}"
                   MaxHeight="{TemplateBinding MaxDropDownHeight}"
                   PlacementTarget="Background"
                   IsLightDismissEnabled="True"
                   InheritsTransform="True">
              <Border x:Name="PopupBorder"
                      Background="{DynamicResource ComboBoxBackgroundBrush}"
                      BorderBrush="{DynamicResource ComboBoxBorderBrush}"
                      BorderThickness="1"
                      Margin="0,4,0,4"
                      Padding="4"
                      CornerRadius="8"
                      BoxShadow="0 4 12 0 #40000000">
                <ScrollViewer HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                              VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}">
                  <ItemsPresenter Name="PART_ItemsPresenter"
                                  ItemsPanel="{TemplateBinding ItemsPanel}" />
                </ScrollViewer>
              </Border>
            </Popup>
          </Grid>
        </DataValidationErrors>
      </ControlTemplate>
    </Setter>

    <!-- PointerOver State -->
    <Style Selector="^:pointerover /template/ Border#Background">
      <Setter Property="Background" Value="{DynamicResource ComboBoxBackgroundPointerOverBrush}" />
      <Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderPointerOverBrush}" />
    </Style>

    <!-- Focused State -->
    <Style Selector="^:focus /template/ Border#Background">
      <Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderBrush}" />
      <Setter Property="BorderThickness" Value="1" />
    </Style>

    <!-- DropDownOpen State -->
    <Style Selector="^:dropdownopen /template/ PathIcon#DropDownGlyph">
      <Setter Property="RenderTransform">
        <RotateTransform Angle="180" />
      </Setter>
    </Style>
    <Style Selector="^:dropdownopen /template/ Border#Background">
      <Setter Property="BorderBrush" Value="{DynamicResource ComboBoxBorderBrush}" />
    </Style>

    <!-- Disabled State -->
    <Style Selector="^:disabled">
      <Setter Property="Opacity" Value="0.5" />
      <Style Selector="^ /template/ Border#Background">
        <Setter Property="Background" Value="{DynamicResource ButtonBackgroundDisabledBrush}" />
      </Style>
    </Style>
      </ControlTheme>
    </ResourceDictionary>
  </Styles.Resources>

  <!-- ComboBoxItem styling within ModernComboBox -->
  <Style Selector="controls|ModernComboBox ComboBoxItem">
    <Setter Property="CornerRadius" Value="4" />
    <Setter Property="Margin" Value="0,1" />
    <Setter Property="Padding" Value="12,8" />
    <Setter Property="Background" Value="Transparent" />
  </Style>

  <Style Selector="controls|ModernComboBox ComboBoxItem:pointerover /template/ ContentPresenter">
    <Setter Property="Background" Value="{DynamicResource ComboBoxItemBackgroundPointerOverBrush}" />
  </Style>

  <Style Selector="controls|ModernComboBox ComboBoxItem:selected /template/ ContentPresenter">
    <Setter Property="Background" Value="{DynamicResource AccentButtonBackgroundBrush}" />
    <Setter Property="Foreground" Value="White" />
  </Style>

  <Style Selector="controls|ModernComboBox ComboBoxItem:selected:pointerover /template/ ContentPresenter">
    <Setter Property="Background" Value="{DynamicResource AccentButtonBackgroundBrush}" />
    <Setter Property="Opacity" Value="0.9" />
  </Style>
</Styles>

